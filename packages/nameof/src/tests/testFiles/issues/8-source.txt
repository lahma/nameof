import CodeBlockWriter from "code-block-writer";
import { expect } from "chai";
import { FunctionDefinition, InterfaceMethodDefinition, ClassMethodDefinition } from "./../../definitions";
import { FunctionBodyWriter } from "./../../writers";
import { WriteFlags } from "./../../WriteFlags";
import * as mocks from "./mocks";

suite(
    nameof(FunctionBodyWriter),
    () =>
    {
        function createObjects()
        {
            const writer = new CodeBlockWriter();
            const defWriter = new FunctionBodyWriter(writer);
            return { writer, defWriter };
        }

        suite(
            nameof<FunctionBodyWriter>(w => w.write),
            () =>
            {

                test(
                    `should not write out the function body if ${nameof(WriteFlags.HideFunctionBodies)} is set`,
                    () =>
                    {
                        const def = new FunctionDefinition();
                        const { writer, defWriter } = createObjects();
                        defWriter.write(def, WriteFlags.HideFunctionBodies);
                        expect(writer.toString()).to.equal(";");
                    });

                test(
                    `should not write out the function body if it's an ${nameof(InterfaceMethodDefinition)}`,
                    () =>
                    {
                        const def = new InterfaceMethodDefinition();
                        const { writer, defWriter } = createObjects();
                        defWriter.write(def, WriteFlags.None);
                        expect(writer.toString()).to.equal(";");
                    });
            });
    });
